load("@wfa_rules_kotlin_jvm//kotlin:defs.bzl", "kt_jvm_library")

package(default_visibility = [
    "//src/main/kotlin/org/wfanet/measurement/duchy/mill/trustee:__subpackages__",
    "//src/main/kotlin/org/wfanet/measurement/edpaggregator/resultsfulfiller:__subpackages__",
    "//src/main/kotlin/org/wfanet/measurement/edpaggregator/resultsfulfiller/compute/protocols/direct:__subpackages__",
    "//src/main/kotlin/org/wfanet/measurement/edpaggregator/resultsfulfiller/fulfillers:__subpackages__",
    "//src/main/kotlin/org/wfanet/measurement/eventdataprovider/requisition/v2alpha/common:__pkg__",
    "//src/test/kotlin/org/wfanet/measurement/computation:__subpackages__",
    "//src/test/kotlin/org/wfanet/measurement/duchy/mill/trustee:__subpackages__",
    "//src/test/kotlin/org/wfanet/measurement/edpaggregator/resultsfulfiller:__subpackages__",
])

kt_jvm_library(
    name = "computation_params",
    srcs = ["ComputationParams.kt"],
)

kt_jvm_library(
    name = "differential_privacy_params",
    srcs = ["DifferentialPrivacyParams.kt"],
)

kt_jvm_library(
    name = "impression_computations",
    srcs = ["ImpressionComputations.kt"],
    deps = [
        ":differential_privacy_params",
        ":k_anonymity_params",
        "//imports/java/com/google/privacy:differential_privacy",
    ],
)

kt_jvm_library(
    name = "k_anonymity_params",
    srcs = ["KAnonymityParams.kt"],
    deps = [
        ":computation_params",
    ],
)

kt_jvm_library(
    name = "histogram_computations",
    srcs = ["HistogramComputations.kt"],
)

kt_jvm_library(
    name = "reach_and_frequency_computations",
    srcs = ["ReachAndFrequencyComputations.kt"],
    deps = [
        ":differential_privacy_params",
        ":k_anonymity_params",
        "//imports/java/com/google/privacy:differential_privacy",
    ],
)

kt_jvm_library(
    name = "frequency_vector_anonymization",
    srcs = ["FrequencyVectorAnonymization.kt"],
    deps = [
        ":histogram_computations",
        ":k_anonymity_params",
        ":reach_and_frequency_computations",
        "//src/main/kotlin/org/wfanet/measurement/eventdataprovider/requisition/v2alpha/common:frequency_vector_builder",
        "//src/main/proto/wfa/frequency_count:frequency_count_kt_jvm_proto",
        "@wfa_measurement_proto//src/main/proto/wfa/measurement/api/v2alpha:measurement_spec_kt_jvm_proto",
        "@wfa_measurement_proto//src/main/proto/wfa/measurement/api/v2alpha:population_spec_kt_jvm_proto",
    ],
)
